<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tableplots • eatPlot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tableplots">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eatPlot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9005</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/default_lists.html">Default lists</a></li>
    <li><a class="dropdown-item" href="../articles/faq_bt24.html">FAQ BT24</a></li>
    <li><a class="dropdown-item" href="../articles/lineplots.html">Lineplots</a></li>
    <li><a class="dropdown-item" href="../articles/loop_example.html">Mehrere Kompetenzbereiche: Schleifen</a></li>
    <li><a class="dropdown-item" href="../articles/tableplots.html">Tableplots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Tableplots</h1>
            
      

      <div class="d-none name"><code>tableplots.Rmd</code></div>
    </div>

    
    
<p>This vignette shows you how to plot tableplots from
<code>eatRep</code> data. The workflow is optimized for
Bildungstrend-graphs, but can be expanded for plotting other
<code>eatRep</code> data as well.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nickhaf.github.io/eatPlot/">eatPlot</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="geschlechterkapitel">Geschlechterkapitel<a class="anchor" aria-label="anchor" href="#geschlechterkapitel"></a>
</h2>
<div class="section level3">
<h3 id="abbildung-6-5">Abbildung 6.5<a class="anchor" aria-label="anchor" href="#abbildung-6-5"></a>
</h3>
<p>First we prepare the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gender_prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">trend_gender</span>, <span class="va">prep_tablebarplot</span>, subgroup_var <span class="op">=</span> <span class="st">"Kgender"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now, we only want to plot the comparison of male vs. female. The
direction is always the same, we can look that up in the plain data,
therefore it doesn’t matter which one we filter:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gender_prepped_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">gender_prepped</span>, <span class="va">subgroup_var</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gender_prepped</span> <span class="op">&lt;-</span> <span class="va">gender_prepped_sub</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">gender_prepped_sub</span><span class="op">$</span><span class="va">state_var</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">gender_prepped</span><span class="op">$</span><span class="va">y_axis</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">gender_prepped</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gender_prepped</span><span class="op">$</span><span class="va">state_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_bundesland.html">process_bundesland</a></span><span class="op">(</span><span class="va">gender_prepped</span><span class="op">$</span><span class="va">state_var</span>, linebreak <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The tables need some more work, because they need to be connected
with the barplot, but only have half the rows. Therefore we need to
build separate variables for each table part, with the respective rows
of the domain not plotted in the table half set to empty strings.
Because we want to plot both competence areas next to each other, we
have to do some minor data wrangling first:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gender_prepped_lesen</span> <span class="op">&lt;-</span> <span class="va">gender_prepped</span></span>
<span><span class="va">gender_prepped_lesen</span><span class="op">[</span><span class="va">gender_prepped_lesen</span><span class="op">$</span><span class="va">kb</span> <span class="op">==</span> <span class="st">"hoeren"</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gender_prepped</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y_axis"</span>, <span class="st">"kb"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">gender_prepped_hoeren</span> <span class="op">&lt;-</span> <span class="va">gender_prepped</span></span>
<span><span class="va">gender_prepped_hoeren</span><span class="op">[</span><span class="va">gender_prepped_hoeren</span><span class="op">$</span><span class="va">kb</span> <span class="op">==</span> <span class="st">"lesen"</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gender_prepped</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y_axis"</span>, <span class="st">"kb"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">gender_prepped_lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">gender_prepped_lesen</span>, <span class="va">gender_prepped_hoeren</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y_axis"</span>, <span class="st">"kb"</span><span class="op">)</span>, suffixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_lesen"</span>, <span class="st">"_hören"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gender_prepped_lh_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span></span>
<span>  <span class="va">gender_prepped_lh</span>,</span>
<span>  <span class="va">gender_prepped</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"y_axis"</span>,</span>
<span>    <span class="st">"est_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span>,</span>
<span>    <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span></span>
<span>  <span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">gender_prepped_lh_final</span> <span class="op">&lt;-</span> <span class="va">gender_prepped_lh_final</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">gender_prepped_lh_final</span><span class="op">$</span><span class="va">y_axis</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>Now we can plot the table like usual, with one exception: I can nudge
the table contents a bit downwards, so they also fill the empty row.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tableplot_6.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tablebarplot.html">plot_tablebarplot</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">gender_prepped_lh_final</span>,</span>
<span>  bar_est <span class="op">=</span> <span class="st">"est_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span>,</span>
<span>  bar_fill <span class="op">=</span> <span class="st">"kb"</span>,</span>
<span>  bar_sig <span class="op">=</span> <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span>,</span>
<span>  columns_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"state_var_lesen"</span>,</span>
<span>    <span class="st">"est_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_lesen"</span>,</span>
<span>    <span class="st">"se_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_lesen"</span>,</span>
<span>    <span class="st">"es_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_lesen"</span>,</span>
<span>    <span class="st">"est_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_hören"</span>,</span>
<span>    <span class="st">"se_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_hören"</span>,</span>
<span>    <span class="st">"es_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_hören"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_sig_bold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_lesen"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_lesen"</span>,</span>
<span>    <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_hören"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_hören"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_sig_superscript <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_crossDiff_of_groupDiff_totalFacet_femaleSubgroup_2022_lesen"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_crossDiff_of_groupDiff_totalFacet_femaleSubgroup_2022_lesen"</span>,</span>
<span>    <span class="st">"sig_mean_comp_crossDiff_of_groupDiff_totalFacet_femaleSubgroup_2022_hören"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_crossDiff_of_groupDiff_totalFacet_femaleSubgroup_2022_hören"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_round <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  columns_table_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"se_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_lesen"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"se_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022_hören"</span>,</span>
<span>    <span class="cn">NULL</span></span>
<span>  <span class="op">)</span>,</span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"**Land**"</span>,</span>
<span>    <span class="st">"*M*&lt;sub&gt;M&lt;/sub&gt;-*M*&lt;sub&gt;J&lt;/sub&gt;"</span>,</span>
<span>    <span class="st">"(*SE*)"</span>,</span>
<span>    <span class="st">"*d*"</span>,</span>
<span>    <span class="st">"*M*&lt;sub&gt;M&lt;/sub&gt;-*M*&lt;sub&gt;J&lt;/sub&gt;"</span>,</span>
<span>    <span class="st">"(*SE*)"</span>,</span>
<span>    <span class="st">"*d*"</span>,</span>
<span>    <span class="st">"**Vorsprung zugunsten der&lt;br&gt;Mädchen**"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  column_spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"**Leseverstehen**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"**Hörverstehen**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  y_axis <span class="op">=</span> <span class="st">"y_axis"</span>,</span>
<span>  plot_settings <span class="op">=</span> <span class="fu"><a href="../reference/plotsettings_tablebarplot.html">plotsettings_tablebarplot</a></span><span class="op">(</span></span>
<span>    default_list <span class="op">=</span> <span class="va">abb_6.5</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally we can save the plot:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_plot.html">save_plot</a></span><span class="op">(</span><span class="va">tableplot_6.5</span>, filename <span class="op">=</span> <span class="st">"C:/Users/hafiznij/Downloads/abb6.5.pdf"</span>, width <span class="op">=</span> <span class="fl">160</span>, height <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tableplot_6.5</span></span></code></pre></div>
<p><img src="tableplots_files/figure-html/unnamed-chunk-9-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="abbildung-6-6">Abbildung 6.6<a class="anchor" aria-label="anchor" href="#abbildung-6-6"></a>
</h3>
<p>First the data has to be prepared:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gender_prepped_mean_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">trend_gender</span>,</span>
<span>  <span class="va">prep_tablebarplot</span>,</span>
<span>  subgroup_var <span class="op">=</span> <span class="st">"Kgender"</span>,</span>
<span>  parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Let's focus on:</span></span>
<span></span>
<span><span class="va">gender_lesen</span> <span class="op">&lt;-</span> <span class="va">gender_prepped_mean_sd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Afterwards, we have to bring it in the format we want to plot it
in:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gender_lesen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">gender_lesen</span>, <span class="va">subgroup_var</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## females should be the first row always:</span></span>
<span><span class="va">gender_lesen</span> <span class="op">&lt;-</span> <span class="va">gender_lesen</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">gender_lesen</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">gender_lesen</span> <span class="op">&lt;-</span> <span class="va">gender_lesen</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">gender_lesen</span><span class="op">$</span><span class="va">state_var</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">gender_lesen</span><span class="op">$</span><span class="va">state_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_bundesland.html">process_bundesland</a></span><span class="op">(</span><span class="va">gender_lesen</span><span class="op">$</span><span class="va">state_var</span>, linebreak <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## Depending on whether a column has a linebreak, they have to be nudged down. I define the according vector here already, because it might get confusing furhter down:</span></span>
<span><span class="va">nudge_col1_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"&lt;br&gt;"</span>, <span class="va">gender_lesen</span><span class="op">$</span><span class="va">state_var</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">gender_lesen</span><span class="op">$</span><span class="va">state_var</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">gender_lesen</span><span class="op">$</span><span class="va">state_var</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">" "</span></span>
<span><span class="va">gender_lesen</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"^male"</span>, <span class="st">"Jungen"</span>, <span class="va">gender_lesen</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">gender_lesen</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"Mädchen"</span>, <span class="va">gender_lesen</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">gender_lesen</span><span class="op">$</span><span class="va">empty</span> <span class="op">&lt;-</span> <span class="st">""</span></span></code></pre></div>
<p>We will have to plot multiple plots and combine them. To do that, we
will have to set the column widths, so they are identical over the
different plots:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">column_widths_stand</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_column_width.html">standardize_column_width</a></span><span class="op">(</span></span>
<span>  column_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    p1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.085</span>, <span class="fl">0.05</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.035</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fl">0.015</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.035</span>, <span class="fl">3</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.035</span>, <span class="fl">3</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  plot_ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">142</span>, <span class="fl">142</span><span class="op">)</span> <span class="co"># Ranges of the x-axes of both plots set in 'axis_x_lims'.</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can just use this object in the plot-settings to adjust the column
widths.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tablebarplot.html">plot_tablebarplot</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">gender_lesen</span>,</span>
<span>  bar_est <span class="op">=</span> <span class="st">"est_mean_comp_trend_sameFacet_sameSubgroup_2009_2015"</span>,</span>
<span>  bar_label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bar_sig <span class="op">=</span> <span class="st">"sig_mean_comp_trend_sameFacet_sameSubgroup_2009_2015"</span>,</span>
<span>  bar_fill <span class="op">=</span> <span class="st">"subgroup_var"</span>,</span>
<span>  column_spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"**2009**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>    <span class="st">"**2015**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    <span class="st">"**2022**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>    <span class="st">"**Differenz 2015-2009**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">13</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="st">"se_mean_comp_trend_sameFacet_sameSubgroup_2009_2015"</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"**Land**"</span>, <span class="st">" "</span>, <span class="st">"*M*"</span>, <span class="st">"*SD*"</span>, <span class="st">"*M*"</span>, <span class="st">"*SD*"</span>, <span class="st">"*M*"</span>, <span class="st">"*SD*"</span>, <span class="st">""</span>, <span class="st">"*M*&lt;sub&gt;2015&lt;/sub&gt;-&lt;br&gt;*M*&lt;sub&gt;2009&lt;/sub&gt; "</span>, <span class="st">"(*SE*)"</span>, <span class="st">"*d*"</span>, <span class="st">" "</span><span class="op">)</span>,</span>
<span>  columns_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"state_var"</span>,</span>
<span>    <span class="st">"subgroup_var"</span>,</span>
<span>    <span class="st">"est_mean_comp_none_2009"</span>,</span>
<span>    <span class="st">"est_sd_comp_none_2009"</span>,</span>
<span>    <span class="st">"est_mean_comp_none_2015"</span>,</span>
<span>    <span class="st">"est_sd_comp_none_2015"</span>,</span>
<span>    <span class="st">"est_mean_comp_none_2022"</span>,</span>
<span>    <span class="st">"est_sd_comp_none_2022"</span>,</span>
<span>    <span class="st">"empty"</span>,</span>
<span>    <span class="st">"est_mean_comp_trend_sameFacet_sameSubgroup_2009_2015"</span>,</span>
<span>    <span class="st">"se_mean_comp_trend_sameFacet_sameSubgroup_2009_2015"</span>,</span>
<span>    <span class="st">"es_mean_comp_trend_sameFacet_sameSubgroup_2009_2015"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_sig_bold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_crossDiff_totalFacet_sameSubgroup_2009"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_crossDiff_totalFacet_sameSubgroup_2015"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_crossDiff_totalFacet_sameSubgroup_2022"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_trend_sameFacet_sameSubgroup_2009_2015"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_trend_sameFacet_sameSubgroup_2009_2015"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_sig_superscript <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="st">"sig_mean_comp_trend_crossDiff_totalFacet_sameSubgroup_2009_2015"</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  y_axis <span class="op">=</span> <span class="st">"y_axis"</span>,</span>
<span>  columns_round <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  plot_settings <span class="op">=</span> <span class="fu"><a href="../reference/plotsettings_tablebarplot.html">plotsettings_tablebarplot</a></span><span class="op">(</span></span>
<span>    bar_pattern_spacing <span class="op">=</span> <span class="fl">0.01</span>, <span class="co">## Try out what look good. For own plots, take the template ones as orientation</span></span>
<span>    columns_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    columns_width <span class="op">=</span> <span class="va">column_widths_stand</span><span class="op">$</span><span class="va">p1</span>, <span class="co">## This is the column-width object we set above</span></span>
<span>    columns_nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">9</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    columns_nudge_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">nudge_col1_y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    headers_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">7</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    headers_nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">9</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    default_list <span class="op">=</span> <span class="va">abb_6.6</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tablebarplot.html">plot_tablebarplot</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">gender_lesen</span>,</span>
<span>  bar_est <span class="op">=</span> <span class="st">"est_mean_comp_trend_sameFacet_sameSubgroup_2015_2022"</span>,</span>
<span>  bar_label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bar_sig <span class="op">=</span> <span class="st">"sig_mean_comp_trend_sameFacet_sameSubgroup_2015_2022"</span>,</span>
<span>  bar_fill <span class="op">=</span> <span class="st">"subgroup_var"</span>,</span>
<span>  column_spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"**Differenz 2022-2015**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"*M*&lt;sub&gt;2022&lt;/sub&gt;-&lt;br&gt;*M*&lt;sub&gt;2015&lt;/sub&gt; "</span>,</span>
<span>    <span class="st">"(*SE*)"</span>,</span>
<span>    <span class="st">"*d*"</span>,</span>
<span>    <span class="st">" "</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"est_mean_comp_trend_sameFacet_sameSubgroup_2015_2022"</span>,</span>
<span>    <span class="st">"se_mean_comp_trend_sameFacet_sameSubgroup_2015_2022"</span>,</span>
<span>    <span class="st">"es_mean_comp_trend_sameFacet_sameSubgroup_2015_2022"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="st">"se_mean_comp_trend_sameFacet_sameSubgroup_2015_2022"</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  columns_table_sig_bold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"sig_mean_comp_trend_sameFacet_sameSubgroup_2015_2022"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_trend_sameFacet_sameSubgroup_2015_2022"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_sig_superscript <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sig_mean_comp_trend_crossDiff_totalFacet_sameSubgroup_2015_2022"</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  y_axis <span class="op">=</span> <span class="st">"y_axis"</span>,</span>
<span>  columns_round <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  plot_settings <span class="op">=</span> <span class="fu"><a href="../reference/plotsettings_tablebarplot.html">plotsettings_tablebarplot</a></span><span class="op">(</span></span>
<span>    bar_pattern_spacing <span class="op">=</span> <span class="fl">0.017</span>,</span>
<span>    columns_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    columns_width <span class="op">=</span> <span class="va">column_widths_stand</span><span class="op">$</span><span class="va">p2</span>, <span class="co">## This is the column-width object we set above</span></span>
<span>    headers_nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    headers_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    default_list <span class="op">=</span> <span class="va">abb_6.6</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>These values have to be set in the plot-settings above.</p>
<p>Now we can combine the plots:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tableplot_6.6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_plots.html">combine_plots</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p_1</span>, <span class="va">p_2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And save the result:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_plot.html">save_plot</a></span><span class="op">(</span><span class="va">tableplot_6.6</span>, filename <span class="op">=</span> <span class="st">"C:/Users/hafiznij/Downloads/abb_6.6.pdf"</span>, width <span class="op">=</span> <span class="fl">235</span>, height <span class="op">=</span> <span class="fl">130</span><span class="op">)</span></span></code></pre></div>
<p><img src="tableplots_files/figure-html/unnamed-chunk-16-1.png"><!-- --></p>
</div>
</div>
<div class="section level2">
<h2 id="zuwanderungskapitel">Zuwanderungskapitel<a class="anchor" aria-label="anchor" href="#zuwanderungskapitel"></a>
</h2>
<p>Currently use the <code>gender_trend</code> data for demonstration
purposes, the subgroups are of course named differently for the actual
chapter.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gender_prepped_2</span> <span class="op">&lt;-</span> <span class="va">gender_prepped</span><span class="op">[</span><span class="va">gender_prepped</span><span class="op">$</span><span class="va">kb</span> <span class="op">==</span> <span class="st">"lesen"</span>, <span class="op">]</span></span>
<span><span class="va">gender_prepped_2</span><span class="op">$</span><span class="va">empty</span> <span class="op">&lt;-</span> <span class="st">""</span> <span class="co">## Needes as a empty space between column spanners</span></span>
<span><span class="va">gender_prepped_2</span><span class="op">$</span><span class="va">state_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_bundesland.html">process_bundesland</a></span><span class="op">(</span><span class="va">gender_prepped_2</span><span class="op">$</span><span class="va">state_var</span>, linebreak <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">column_widths_stand</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_column_width.html">standardize_column_width</a></span><span class="op">(</span></span>
<span>  column_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    p1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.16</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.045</span>, <span class="fl">5</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.015</span>, <span class="fl">0.07</span>, <span class="fl">0.045</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    p3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.07</span>, <span class="fl">0.045</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  plot_ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">65</span><span class="op">)</span> <span class="co"># Range of the x-axes of both plots set in 'axis_x_lims'.</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tablebarplot.html">plot_tablebarplot</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">gender_prepped_2</span>,</span>
<span>  bar_est <span class="op">=</span> <span class="st">"est_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span>,</span>
<span>  bar_sig <span class="op">=</span> <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span>,</span>
<span>  column_spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"**2009**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="st">"**2015**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">"**2022**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  column_spanners_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"**Differenz Schüler:innen mit - Schüler:innen ohne &lt;br&gt; Zuwanderungshintergrund**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="st">"se_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"bold(Land)"</span>,</span>
<span>    <span class="st">"Delta * italic(M)"</span>,</span>
<span>    <span class="st">"Delta * italic(M)"</span>,</span>
<span>    <span class="st">"Delta * italic(M)"</span>,</span>
<span>    <span class="st">"(italic(SE))"</span>,</span>
<span>    <span class="st">"italic(d)"</span>,</span>
<span>    <span class="st">" "</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"state_var"</span>,</span>
<span>    <span class="st">"est_mean_comp_groupDiff_sameFacet_femaleSubgroup_2009"</span>,</span>
<span>    <span class="st">"est_mean_comp_groupDiff_sameFacet_femaleSubgroup_2015"</span>,</span>
<span>    <span class="st">"est_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span>,</span>
<span>    <span class="st">"se_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span>,</span>
<span>    <span class="st">"es_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_sig_bold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2009"</span>,</span>
<span>    <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2015"</span>,</span>
<span>    <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span>,</span>
<span>    <span class="cn">NULL</span>,</span>
<span>    <span class="st">"sig_mean_comp_groupDiff_sameFacet_femaleSubgroup_2022"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_round <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  y_axis <span class="op">=</span> <span class="st">"y_axis"</span>,</span>
<span>  plot_settings <span class="op">=</span> <span class="fu"><a href="../reference/plotsettings_tablebarplot.html">plotsettings_tablebarplot</a></span><span class="op">(</span></span>
<span>    bar_pattern_spacing <span class="op">=</span> <span class="fl">0.0274</span>,</span>
<span>    columns_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    columns_width <span class="op">=</span> <span class="va">column_widths_stand</span><span class="op">$</span><span class="va">p1</span>,</span>
<span>    default_list <span class="op">=</span> <span class="va">abb_8.4</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tablebarplot.html">plot_tablebarplot</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">gender_prepped_2</span>,</span>
<span>  bar_est <span class="op">=</span> <span class="st">"est_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2009_2015"</span>,</span>
<span>  bar_sig <span class="op">=</span> <span class="st">"sig_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2009_2015"</span>,</span>
<span>  column_spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"**2015-2009**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  column_spanners_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"**Veränderung der Differenz&lt;br&gt;**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="st">"se_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2009_2015"</span><span class="op">)</span>,</span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">" "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="st">"paste(Delta * italic(M[2015]), '-')"</span>,</span>
<span>      <span class="st">"Delta * italic(M[2009])"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="st">"(italic(SE))"</span>,</span>
<span>    <span class="st">" "</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"empty"</span>,</span>
<span>    <span class="st">"est_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2009_2015"</span>,</span>
<span>    <span class="st">"se_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2009_2015"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_sig_bold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="cn">NULL</span>, <span class="st">"sig_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2009_2015"</span>, <span class="cn">NULL</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_round <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  y_axis <span class="op">=</span> <span class="st">"y_axis"</span>,</span>
<span>  plot_settings <span class="op">=</span></span>
<span>    <span class="fu"><a href="../reference/plotsettings_tablebarplot.html">plotsettings_tablebarplot</a></span><span class="op">(</span></span>
<span>      bar_pattern_spacing <span class="op">=</span> <span class="fl">0.0334</span>,</span>
<span>      columns_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      headers_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      headers_nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      columns_width <span class="op">=</span> <span class="va">column_widths_stand</span><span class="op">$</span><span class="va">p2</span>,</span>
<span>      default_list <span class="op">=</span> <span class="va">abb_8.4</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tablebarplot.html">plot_tablebarplot</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">gender_prepped_2</span>,</span>
<span>  bar_est <span class="op">=</span> <span class="st">"est_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2015_2022"</span>,</span>
<span>  bar_sig <span class="op">=</span> <span class="st">"sig_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2015_2022"</span>,</span>
<span>  column_spanners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"**2022-2015**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  column_spanners_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"**Veränderung der Differenz&lt;br&gt;**"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="st">"se_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2015_2022"</span><span class="op">)</span>,</span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="st">"paste(Delta * italic(M[2022]), '-')"</span>,</span>
<span>      <span class="st">"Delta * italic(M[2015])"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="st">"(italic(SE))"</span>,</span>
<span>    <span class="st">" "</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"est_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2015_2022"</span>,</span>
<span>    <span class="st">"se_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2015_2022"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_table_sig_bold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"sig_mean_comp_trend_groupDiff_sameFacet_femaleSubgroup_2015_2022"</span>, <span class="cn">NULL</span></span>
<span>  <span class="op">)</span>,</span>
<span>  columns_round <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  y_axis <span class="op">=</span> <span class="st">"y_axis"</span>,</span>
<span>  plot_settings <span class="op">=</span> <span class="fu"><a href="../reference/plotsettings_tablebarplot.html">plotsettings_tablebarplot</a></span><span class="op">(</span></span>
<span>    bar_pattern_spacing <span class="op">=</span> <span class="fl">0.0392</span>,</span>
<span>    axis_x_lims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">45</span><span class="op">)</span>,</span>
<span>    columns_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    headers_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    headers_nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    columns_width <span class="op">=</span> <span class="va">column_widths_stand</span><span class="op">$</span><span class="va">p3</span>,</span>
<span>    default_list <span class="op">=</span> <span class="va">abb_8.4</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tableplot_8.4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_plots.html">combine_plots</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p_1</span>, <span class="va">p_2</span>, <span class="va">p_3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_plot.html">save_plot</a></span><span class="op">(</span><span class="va">tableplot_8.4</span>,</span>
<span>  filename <span class="op">=</span> <span class="st">"C:/Users/hafiznij/Downloads/abb_8.4.pdf"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">160</span>, height <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tableplot_8.4</span></span></code></pre></div>
<p><img src="tableplots_files/figure-html/unnamed-chunk-24-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="stacked-barplot-abbildung-9-1">Stacked Barplot (Abbildung 9.1)<a class="anchor" aria-label="anchor" href="#stacked-barplot-abbildung-9-1"></a>
</h2>
<p>The data preperation for the stacked barplots is a bit more
complicated. Most likely, we will have to run at least to analyses with
<code>eatRep</code>, one for the percentages, and one for the means. We
prepare both analyses seperately and then merge them:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_tablebarplot.html">prep_tablebarplot</a></span><span class="op">(</span><span class="va">anteile</span>,</span>
<span>  subgroup_var <span class="op">=</span> <span class="st">"Kgender"</span>,</span>
<span>  parameter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parameter_to_colname <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="co">## This is important, because our parameter column contains the levels of the dependent Variable. They need to stay in the long format for this one!</span></span>
<span></span>
<span><span class="va">dat_prepped_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_tablebarplot.html">prep_tablebarplot</a></span><span class="op">(</span><span class="va">means</span>,</span>
<span>  subgroup_var <span class="op">=</span> <span class="st">"Kgender"</span>,</span>
<span>  parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>  parameter_to_colname <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co">## Here we don't need the long format for the parameters, so we pivot them wider and create parameter specific columns for each comparison!</span></span></code></pre></div>
<p>Now I have to do some extra data prep so the data looks as
whished:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Recode subgroup columns</span></span>
<span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"weiblich"</span>, <span class="st">"Mädchen"</span>, <span class="va">dat_prepped</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"maennlich"</span>, <span class="st">"Jungen"</span>, <span class="va">dat_prepped</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"total"</span>, <span class="st">"Gesamt"</span>, <span class="va">dat_prepped</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Don't Plot Ncases</span></span>
<span><span class="va">dat_prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_prepped</span>, <span class="va">parameter</span> <span class="op">!=</span> <span class="st">"Ncases"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Make parameter an ordered factor to steer the order of the stacked bars</span></span>
<span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">parameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">parameter</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"niedrig"</span>, <span class="st">"mittel"</span>, <span class="st">"hoch"</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Sort data</span></span>
<span><span class="va">dat_prepped</span> <span class="op">&lt;-</span> <span class="va">dat_prepped</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co">## Build bar labels</span></span>
<span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">est_NA_comp_none</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Only plot results for the whole of germany</span></span>
<span><span class="va">dat_prepped</span> <span class="op">&lt;-</span> <span class="va">dat_prepped</span><span class="op">[</span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">state_var</span> <span class="op">==</span> <span class="st">"total"</span>, <span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="co">## Multiply with 100 to show the perercentages</span></span>
<span><span class="va">dat_prepped</span><span class="op">$</span><span class="va">est_NA_comp_none</span> <span class="op">&lt;-</span> <span class="va">dat_prepped</span><span class="op">$</span><span class="va">est_NA_comp_none</span> <span class="op">*</span> <span class="fl">100</span></span></code></pre></div>
<p>This next part is only necessary because my example data does not
contain enough subgroups and dependent variable for the actual plot, so
I copy paste them onto the data. You can ignore the next chunk. However,
if you have multiple <code>eatRep</code>-datasets with different
dependent variables, you might need to <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code> them
together to put them together into one plot. I do the same here with my
copied data.</p>
<details><summary>
Show Code
</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Add additonal subgroups to the data:</span></span>
<span><span class="va">dat_prepped_other_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_prepped</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span>, <span class="va">subgroup_var</span> <span class="op">!=</span> <span class="st">"Gesamt"</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_other_groups</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Jungen"</span>, <span class="st">"maximal 100 Bücher"</span>, <span class="va">dat_prepped_other_groups</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_other_groups</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Mädchen"</span>, <span class="st">"mehr als 100 Bücher"</span>, <span class="va">dat_prepped_other_groups</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_other_groups2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_prepped</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span>, <span class="va">subgroup_var</span> <span class="op">!=</span> <span class="st">"Gesamt"</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_other_groups2</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Jungen"</span>, <span class="st">"mit Zuwanderungshintergrund"</span>, <span class="va">dat_prepped_other_groups2</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_other_groups2</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Mädchen"</span>, <span class="st">"ohne Zuwanderungshintergrund"</span>, <span class="va">dat_prepped_other_groups2</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Because the subgroups are also written into the colnames, I manually rename the columns.</span></span>
<span><span class="co">## Not needed if you actually have different groups in your data.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_prepped_other_groups</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"maennlich"</span>, <span class="st">"max100books"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_prepped_other_groups</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_prepped_other_groups</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"weiblich"</span>, <span class="st">"more100books"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_prepped_other_groups</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_prepped_other_groups2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"maennlich"</span>, <span class="st">"ZWH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_prepped_other_groups2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_prepped_other_groups2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"weiblich"</span>, <span class="st">"noZWH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_prepped_other_groups2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_prepped_3</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">dat_prepped</span>, <span class="va">dat_prepped_other_groups</span>, <span class="va">dat_prepped_other_groups2</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">## Sort data. Make subgroup_var into an ordered Factor for that</span></span>
<span><span class="va">dat_prepped_3</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat_prepped_3</span><span class="op">$</span><span class="va">subgroup_var</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gesamt"</span>, <span class="st">"Mädchen"</span>, <span class="st">"Jungen"</span>, <span class="st">"mehr als 100 Bücher"</span>, <span class="st">"maximal 100 Bücher"</span>, <span class="st">"mit Zuwanderungshintergrund"</span>, <span class="st">"ohne Zuwanderungshintergrund"</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_3</span> <span class="op">&lt;-</span> <span class="va">dat_prepped_3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dat_prepped_3</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co">## Fill in the subheader into that empty row. Set to NA for all but the first!</span></span>
<span><span class="co">## Add an empty row on top</span></span>
<span><span class="va">na_row</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat_prepped_3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">na_row</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_prepped_3</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">na_row</span>, <span class="va">dat_prepped_3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_prepped_3</span><span class="op">$</span><span class="va">var</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">dat_prepped_3</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"var"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"**Allgemeine Schulzufriedenheit**"</span></span>
<span></span>
<span></span>
<span><span class="co">## Also add values for the y-axis. In tis case it is important that all values, that should be plotted into one row also receive the same values:</span></span>
<span><span class="va">dat_prepped_3</span><span class="op">$</span><span class="va">y_axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Now I can copy this data to simulate other dependent variables</span></span>
<span><span class="va">dat_var2</span> <span class="op">&lt;-</span> <span class="va">dat_prepped_3</span></span>
<span><span class="va">dat_var2</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"var"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"**Soziale Eingebundenheit**"</span></span>
<span><span class="va">dat_var2</span><span class="op">$</span><span class="va">depVar</span> <span class="op">&lt;-</span> <span class="st">"sozEingeb"</span></span>
<span><span class="va">dat_var2</span><span class="op">$</span><span class="va">y_axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">dat_var3</span> <span class="op">&lt;-</span> <span class="va">dat_var2</span></span>
<span><span class="va">dat_var3</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"var"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"**Emotionale Probleme**"</span></span>
<span><span class="va">dat_var3</span><span class="op">$</span><span class="va">depVar</span> <span class="op">&lt;-</span> <span class="st">"emoProb"</span></span>
<span><span class="va">dat_var3</span><span class="op">$</span><span class="va">y_axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">22</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">23</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_var4</span> <span class="op">&lt;-</span> <span class="va">dat_var3</span></span>
<span><span class="va">dat_var4</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"var"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"**Hyperaktivität**"</span></span>
<span><span class="va">dat_var4</span><span class="op">$</span><span class="va">depVar</span> <span class="op">&lt;-</span> <span class="st">"hyperAkt"</span></span>
<span><span class="va">dat_var4</span><span class="op">$</span><span class="va">y_axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">32</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">26</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">27</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">28</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">29</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">31</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dat_prepped_3</span>, <span class="va">dat_var2</span>, <span class="va">dat_var3</span>, <span class="va">dat_var4</span><span class="op">)</span></span></code></pre></div>
</details><p>Now we can plot the stacked bars:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Nudging all the rows into the correct position is a bit more complicated here, so I define a vector for it that can be used multiple times:</span></span>
<span><span class="va">nudge_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.125</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.125</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.125</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_stacked</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tablebarplot.html">plot_tablebarplot</a></span><span class="op">(</span><span class="va">dat</span>,</span>
<span>  bar_est <span class="op">=</span> <span class="st">"est_NA_comp_none"</span>,</span>
<span>  bar_label <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>  bar_fill <span class="op">=</span> <span class="st">"parameter"</span>,</span>
<span>  columns_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"var"</span>, <span class="st">"subgroup_var"</span><span class="op">)</span>,</span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"**Merkmal**"</span>, <span class="st">""</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>  y_axis <span class="op">=</span> <span class="st">"y_axis"</span>,</span>
<span>  plot_settings <span class="op">=</span> <span class="fu"><a href="../reference/plotsettings_tablebarplot.html">plotsettings_tablebarplot</a></span><span class="op">(</span></span>
<span>    bar_fill_colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"niedrig"</span> <span class="op">=</span> <span class="st">"#20D479"</span>, <span class="st">"mittel"</span> <span class="op">=</span> <span class="st">"#8DEBBC"</span>, <span class="st">"hoch"</span> <span class="op">=</span> <span class="st">"#EBFDF3"</span><span class="op">)</span>,</span>
<span>    bar_label_colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"niedrig"</span> <span class="op">=</span> <span class="st">"white"</span>, <span class="st">"mittel"</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="st">"hoch"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    columns_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    columns_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.3</span>, <span class="fl">0.675</span><span class="op">)</span>,</span>
<span>    bar_label_nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    bar_label_nudge_y <span class="op">=</span> <span class="va">nudge_rows</span>,</span>
<span>    bar_nudge_y <span class="op">=</span> <span class="va">nudge_rows</span>,</span>
<span>    columns_nudge_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">nudge_rows</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    default_list <span class="op">=</span> <span class="va">abb_9.1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we can prepare the second part of the plot, showing the means. We
use the prepped means from the separate analysis.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## It is important that the resulting table has the same number of rows as the stacked one.</span></span>
<span></span>
<span><span class="co">## First, filter and recode the data as needed</span></span>
<span><span class="va">dat_prepped_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_prepped_means</span>, <span class="va">state_var</span> <span class="op">==</span> <span class="st">"total"</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_means</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"weiblich"</span>, <span class="st">"Mädchen"</span>, <span class="va">dat_prepped_means</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_means</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"maennlich"</span>, <span class="st">"Jungen"</span>, <span class="va">dat_prepped_means</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_means</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"total"</span>, <span class="st">"Gesamt"</span>, <span class="va">dat_prepped_means</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_prepped_means</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat_prepped_means</span><span class="op">$</span><span class="va">subgroup_var</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gesamt"</span>, <span class="st">"Mädchen"</span>, <span class="st">"Jungen"</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Again I need to prepare the data for the example plot. You can ignore
the next chunk.</p>
<details><summary>
Show Code
</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Again, copy the data to simulate other subgroups, that were not actually in the data!</span></span>
<span><span class="va">dat_table_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_prepped_means</span>, <span class="va">subgroup_var</span> <span class="op">!=</span> <span class="st">"Gesamt"</span><span class="op">)</span></span>
<span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Jungen"</span>, <span class="st">"mit Zuwanderungshintergrund"</span>, <span class="va">dat_table_2</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Mädchen"</span>, <span class="st">"ohne Zuwanderungshintergrund"</span>, <span class="va">dat_table_2</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_prepped_means</span>, <span class="va">subgroup_var</span> <span class="op">!=</span> <span class="st">"Gesamt"</span><span class="op">)</span></span>
<span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Jungen"</span>, <span class="st">"maximal 100 Bücher"</span>, <span class="va">dat_table_3</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">subgroup_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Mädchen"</span>, <span class="st">"mehr als 100 Bücher"</span>, <span class="va">dat_table_3</span><span class="op">$</span><span class="va">subgroup_var</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Because the subgroups are also written into the colnames, I manually rename the columns.</span></span>
<span><span class="co">## Not needed if you actually have different groups in your data.</span></span>
<span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">est_mean_comp_groupDiff_sameFacet_more100booksSubgroup_NA</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"maennlich"</span>, <span class="st">"max100books"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"weiblich"</span>, <span class="st">"more100books"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Manually give them other values, not needed if you have actually different groups</span></span>
<span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">est_mean_comp_groupDiff_sameFacet_more100booksSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">est_mean_comp_groupDiff_sameFacet_more100booksSubgroup_NA</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.201</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">se_mean_comp_groupDiff_sameFacet_more100booksSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">se_mean_comp_groupDiff_sameFacet_more100booksSubgroup_NA</span><span class="op">)</span>, <span class="fl">0.02</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">es_mean_comp_groupDiff_sameFacet_more100booksSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">es_mean_comp_groupDiff_sameFacet_more100booksSubgroup_NA</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">est_mean_comp_groupDiff_sameFacet_max100booksSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">est_mean_comp_groupDiff_sameFacet_max100booksSubgroup_NA</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.201</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">se_mean_comp_groupDiff_sameFacet_max100booksSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">se_mean_comp_groupDiff_sameFacet_max100booksSubgroup_NA</span><span class="op">)</span>, <span class="fl">0.02</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">es_mean_comp_groupDiff_sameFacet_max100booksSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_2</span><span class="op">$</span><span class="va">es_mean_comp_groupDiff_sameFacet_max100booksSubgroup_NA</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Same for the other two subgroups</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"maennlich"</span>, <span class="st">"ZWH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"weiblich"</span>, <span class="st">"noZWH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">est_mean_comp_groupDiff_sameFacet_noZWHSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">est_mean_comp_groupDiff_sameFacet_noZWHSubgroup_NA</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.523</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">se_mean_comp_groupDiff_sameFacet_noZWHSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">se_mean_comp_groupDiff_sameFacet_noZWHSubgroup_NA</span><span class="op">)</span>, <span class="fl">0.03</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">es_mean_comp_groupDiff_sameFacet_noZWHSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">es_mean_comp_groupDiff_sameFacet_noZWHSubgroup_NA</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.256</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">est_mean_comp_groupDiff_sameFacet_ZWHSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">est_mean_comp_groupDiff_sameFacet_ZWHSubgroup_NA</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.523</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">se_mean_comp_groupDiff_sameFacet_ZWHSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">se_mean_comp_groupDiff_sameFacet_ZWHSubgroup_NA</span><span class="op">)</span>, <span class="fl">0.03</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">es_mean_comp_groupDiff_sameFacet_ZWHSubgroup_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dat_table_3</span><span class="op">$</span><span class="va">es_mean_comp_groupDiff_sameFacet_ZWHSubgroup_NA</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.256</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">dat_prepped_means</span>, <span class="va">dat_table_2</span>, <span class="va">dat_table_3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Recode the dependent variable to have the same name as in the other data set. Needed for merging.</span></span>
<span><span class="va">dat2</span><span class="op">$</span><span class="va">depVar</span> <span class="op">&lt;-</span> <span class="st">"Sfskde_kurz_imp_kat"</span></span>
<span></span>
<span><span class="co">## I copy the data now to simulate the other dependent variables.</span></span>
<span><span class="va">dat2_var2</span> <span class="op">&lt;-</span> <span class="va">dat2</span></span>
<span><span class="va">dat2_var2</span><span class="op">$</span><span class="va">depVar</span> <span class="op">&lt;-</span> <span class="st">"sozEingeb"</span></span>
<span></span>
<span><span class="va">dat2_var3</span> <span class="op">&lt;-</span> <span class="va">dat2_var2</span></span>
<span><span class="va">dat2_var3</span><span class="op">$</span><span class="va">depVar</span> <span class="op">&lt;-</span> <span class="st">"emoProb"</span></span>
<span></span>
<span><span class="va">dat2_var4</span> <span class="op">&lt;-</span> <span class="va">dat2</span></span>
<span><span class="va">dat2_var4</span><span class="op">$</span><span class="va">depVar</span> <span class="op">&lt;-</span> <span class="st">"hyperAkt"</span></span>
<span></span>
<span></span>
<span><span class="va">dat_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dat2</span>, <span class="va">dat2_var2</span>, <span class="va">dat2_var3</span>, <span class="va">dat2_var4</span><span class="op">)</span></span></code></pre></div>
</details><p>Now that I can merge my mean data with the data I used for the
stacked bars. This ensures that every row receives the correct values.
First, I have to merge together the groupDiff columns, so I can plot
them within the same column in the table. This is important for
displaying the correct values in the table:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The significances and estimates I want to plot are distributed over multiple columns, because they were group-Diffs.</span></span>
<span><span class="co">## I therefore have to pull them together into the same column :</span></span>
<span><span class="va">dat_means</span><span class="op">$</span><span class="va">est_groupDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_cols.html">merge_cols</a></span><span class="op">(</span><span class="va">dat_means</span>, <span class="st">"est"</span>, <span class="st">"groupDiff"</span><span class="op">)</span></span>
<span><span class="va">dat_means</span><span class="op">$</span><span class="va">sig_groupDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_cols.html">merge_cols</a></span><span class="op">(</span><span class="va">dat_means</span>, <span class="st">"sig"</span>, <span class="st">"groupDiff"</span><span class="op">)</span></span>
<span><span class="va">dat_means</span><span class="op">$</span><span class="va">es_groupDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_cols.html">merge_cols</a></span><span class="op">(</span><span class="va">dat_means</span>, <span class="st">"es"</span>, <span class="st">"groupDiff"</span><span class="op">)</span></span>
<span><span class="va">dat_means</span><span class="op">$</span><span class="va">se_groupDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_cols.html">merge_cols</a></span><span class="op">(</span><span class="va">dat_means</span>, <span class="st">"se"</span>, <span class="st">"groupDiff"</span><span class="op">)</span></span></code></pre></div>
<p>Afterwards I can merge the means with the data I used for the stacked
bars, so the rows are aligned in the table:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Now we can merge the data with the data that we used in the stacked barplot.</span></span>
<span><span class="co">## By doing this, we can guarantee easily that the position of the values matches the correct rows in the stacked barplot.</span></span>
<span><span class="co">## Using left_join to preserve the order! BaseR merge doesn't deal with the NAs in the best way here.</span></span>
<span><span class="va">dat_table</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">dat_means</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"depVar"</span>, <span class="st">"subgroup_var"</span>, <span class="st">"state_var"</span>, <span class="st">"est_mean_comp_none_NA"</span>, <span class="st">"est_sd_comp_none_NA"</span>, <span class="st">"est_groupDiff"</span>, <span class="st">"se_groupDiff"</span>, <span class="st">"es_groupDiff"</span>, <span class="st">"sig_groupDiff"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Joining with `by = join_by(depVar, subgroup_var, state_var)`</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Now we can reduce the data set, because we can be sure every row receives a value, due to the y-axis column!</span></span>
<span><span class="va">dat_table_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dat_table</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"depVar"</span>, <span class="st">"subgroup_var"</span>, <span class="st">"state_var"</span>, <span class="st">"est_mean_comp_none_NA"</span>, <span class="st">"est_sd_comp_none_NA"</span>, <span class="st">"est_groupDiff"</span>, <span class="st">"se_groupDiff"</span>, <span class="st">"es_groupDiff"</span>, <span class="st">"sig_groupDiff"</span>, <span class="st">"y_axis"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_table_u</span> <span class="op">&lt;-</span> <span class="va">dat_table_u</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">depVar</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"groupDiff"</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now that we have our data in the correct format, we can plot the
means:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nudge_rows_short</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="op">-</span><span class="fl">0.125</span>, <span class="fl">0.125</span>, <span class="op">-</span><span class="fl">0.125</span>, <span class="fl">0.125</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_tablebarplot.html">plot_tablebarplot</a></span><span class="op">(</span></span>
<span>  <span class="va">dat_table_u</span>,</span>
<span>  columns_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est_mean_comp_none_NA"</span>, <span class="st">"est_sd_comp_none_NA"</span>, <span class="st">"est_groupDiff"</span>, <span class="st">"se_groupDiff"</span>, <span class="st">"es_groupDiff"</span><span class="op">)</span>,</span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bolditalic(M)"</span>, <span class="st">"bolditalic(SD)"</span>, <span class="st">"Delta * bolditalic(M)"</span>, <span class="st">"bolditalic((SE))"</span>, <span class="st">"bolditalic(d)"</span><span class="op">)</span>,</span>
<span>  columns_round <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  columns_table_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="st">"se_groupDiff"</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  y_axis <span class="op">=</span> <span class="st">"y_axis"</span>,</span>
<span>  columns_table_sig_bold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="st">"sig_groupDiff"</span>, <span class="cn">NULL</span>, <span class="st">"sig_groupDiff"</span><span class="op">)</span>,</span>
<span>  plot_settings <span class="op">=</span> <span class="fu"><a href="../reference/plotsettings_tablebarplot.html">plotsettings_tablebarplot</a></span><span class="op">(</span></span>
<span>    columns_alignment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    columns_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>    columns_nudge_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">nudge_rows_short</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">nudge_rows_short</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    headers_ggtext <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    default_list <span class="op">=</span> <span class="va">abb_9.1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_stacked_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_plots.html">combine_plots</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p_stacked</span>, <span class="va">p_table</span><span class="op">)</span>, plot_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Careful! You have provided plot_widths. Please be beware that the</span></span>
<span><span class="co">## x-axes might be distorted, if your plot_widths don't account for different</span></span>
<span><span class="co">## x-axis ranges.</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_plot.html">save_plot</a></span><span class="op">(</span><span class="va">p_stacked_combined</span>, <span class="st">"C:/Users/hafiznij/Downloads/stacked.pdf"</span>, height <span class="op">=</span> <span class="fl">140</span>, width <span class="op">=</span> <span class="fl">160</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_stacked_combined</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 56 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_tile()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 4 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_rect()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 4 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_rich_text()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 56 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_rich_text()`).</span></span>
<span><span class="co">## Removed 56 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_rich_text()`).</span></span></code></pre>
<p><img src="tableplots_files/figure-html/unnamed-chunk-35-1.png"><!-- --></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicklas Hafiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
